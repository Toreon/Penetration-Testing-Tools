<div class="catalogue-container">
  <div class="header-section">
    <h1>Tools Catalogue</h1>
    <p>Browse and filter penetration testing tools</p>
  </div>

  <div class="main-content">
    <!-- Filters Sidebar -->
    <mat-sidenav-container class="sidenav-container">
      <mat-sidenav mode="side" opened class="filters-sidenav">
        <div class="filters-content">
          <h2>Filters</h2>
          
          <!-- Search -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Search</mat-label>
            <input matInput [formControl]="searchControl" placeholder="Search tools...">
            <mat-icon matPrefix>search</mat-icon>
          </mat-form-field>

          <!-- Sort -->
          <mat-form-field appearance="outline" class="full-width">
            <mat-label>Sort by</mat-label>
            <mat-select [formControl]="sortControl">
              <mat-option value="stars-desc">Stars (Most)</mat-option>
              <mat-option value="stars-asc">Stars (Least)</mat-option>
              <mat-option value="name-asc">Name (A-Z)</mat-option>
              <mat-option value="name-desc">Name (Z-A)</mat-option>
              <mat-option value="added_at-desc">Recently Added</mat-option>
            </mat-select>
          </mat-form-field>

          <!-- Categories -->
          <div class="filter-section">
            <h3>Categories</h3>
            <div class="chips-container">
              @for (category of categories; track category) {
                <mat-chip [class.selected]="isCategorySelected(category)" 
                          (click)="toggleCategory(category)"
                          class="filter-chip">
                  {{ category.replace(/_/g, ' ') }}
                </mat-chip>
              }
            </div>
          </div>

          <!-- Platforms -->
          <div class="filter-section">
            <h3>Platforms</h3>
            @for (platform of platforms; track platform) {
              <mat-checkbox [checked]="isPlatformSelected(platform)"
                            (change)="togglePlatform(platform, $event.checked)"
                            class="filter-checkbox">
                {{ platform }}
              </mat-checkbox>
            }
          </div>

          <!-- Licenses -->
          <div class="filter-section">
            <h3>License</h3>
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Select License</mat-label>
              <mat-select formControlName="licenses" multiple>
                @for (license of licenses; track license) {
                  <mat-option [value]="license">{{ license }}</mat-option>
                }
              </mat-select>
            </mat-form-field>
          </div>

          <!-- Maturity -->
          <div class="filter-section">
            <h3>Maturity</h3>
            <mat-form-field appearance="outline" class="full-width">
              <mat-label>Select Maturity</mat-label>
              <mat-select formControlName="maturity" multiple>
                <mat-option value="stable">Stable</mat-option>
                <mat-option value="active">Active</mat-option>
                <mat-option value="experimental">Experimental</mat-option>
                <mat-option value="archived">Archived</mat-option>
              </mat-select>
            </mat-form-field>
          </div>

          <button mat-raised-button color="warn" (click)="clearFilters()" class="clear-button">
            Clear Filters
          </button>
        </div>
      </mat-sidenav>

      <mat-sidenav-content>
        <div class="tools-grid">
          @if (filteredTools.length === 0) {
            <div class="no-results">
              <p>No tools found matching your criteria.</p>
              <button mat-button (click)="clearFilters()">Clear Filters</button>
            </div>
          } @else {
            @for (tool of filteredTools; track tool.id) {
              <mat-card class="tool-card" [routerLink]="['/tools', tool.id]">
                <mat-card-header>
                  <mat-card-title>{{ tool.name }}</mat-card-title>
                  <mat-card-subtitle>
                    @if (tool.stars) {
                      <span class="stars">‚≠ê {{ tool.stars }}</span>
                    }
                  </mat-card-subtitle>
                </mat-card-header>
                <mat-card-content>
                  <p>{{ tool.summary }}</p>
                  <div class="chips">
                    @for (category of tool.categories; track category) {
                      <mat-chip>{{ category.replace(/_/g, ' ') }}</mat-chip>
                    }
                  </div>
                  <div class="platforms">
                    @for (platform of tool.platforms; track platform) {
                      <span class="platform-badge">{{ platform }}</span>
                    }
                  </div>
                </mat-card-content>
              </mat-card>
            }
          }
        </div>
      </mat-sidenav-content>
    </mat-sidenav-container>
  </div>
</div>
